generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql" // or any other database provider you use
  url = env("DATABASE_URL")
}

model Route {
  id              String      @id @default(uuid())
  day             DateTime

  startCityId     String
  startCity       City        @relation("StartCity", fields: [startCityId], references: [id])
  
  endCityId       String
  endCity         City        @relation("EndCity", fields: [endCityId], references: [id])
  
  stops           RouteStop[]

  price           Float

  totalSeats      Int
  emptySeats      Int
  occupiedSeats   Int

  createdAt       DateTime    @default(now())

  @@index([endCityId])
  @@index([startCityId])
}

model City {
  id              String      @id @default(uuid())
  name            String
  value           String

  routesAsStart   Route[]   @relation("StartCity")
  routesAsEnd     Route[]   @relation("EndCity")
  stops           RouteStop[]

  createdAt       DateTime   @default(now())
}

model RouteStop {
  id              String      @id @default(uuid())
  routeId         String
  route           Route       @relation(fields: [routeId], references: [id])
  cityId          String
  city            City        @relation(fields: [cityId], references: [id])

  createdAt       DateTime    @default(now())

  @@index([routeId])
  @@index([cityId])
}
